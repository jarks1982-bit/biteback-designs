{% set state = challengeState or "active" %}

<div class="card" style="margin: 0 20px 12px; display: flex; align-items: center; gap: 14px;
  {% if state == 'fumbled' %}border-color: var(--fumble);{% endif %}
  {% if state == 'redemption' %}border-color: var(--redemption);{% endif %}
">
  <div style="position: relative; width: 44px; height: 44px; flex-shrink: 0;">
    <svg width="44" height="44" viewBox="0 0 44 44">
      <circle cx="22" cy="22" r="20" fill="none" stroke="var(--card-border)" stroke-width="1.5"/>
      <circle cx="22" cy="22" r="20" fill="none" 
        stroke="{% if state == 'redemption' %}var(--redemption){% else %}var(--clutch){% endif %}" 
        stroke-width="1.5"
        stroke-dasharray="{{ (challengeProgress or 0) * 125.6 }} 125.6"
        stroke-linecap="round"
        transform="rotate(-90 22 22)"
      />
    </svg>
    {% if state == 'completed' %}
      <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; color: var(--clutch); font-size: 18px;">âœ“</div>
    {% elif state == 'fumbled' %}
      <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; color: var(--fumble); font-size: 14px;">âœ˜</div>
    {% endif %}
  </div>

  <div style="flex: 1; min-width: 0;">
    <div style="display: flex; align-items: center; gap: 8px;">
      <span style="font-family: var(--font-display); font-weight: 700; font-size: 15px; color: var(--text-primary);">{{ challengeName or "Challenge" }}</span>
      {% if state == 'redemption' %}
        <span style="font-family: var(--font-mono); font-size: 10px; padding: 2px 6px; border-radius: 3px; background: rgba(255, 184, 0, 0.15); color: var(--redemption);">REDEMPTION</span>
      {% endif %}
    </div>
    <div style="font-family: var(--font-mono); font-size: 12px; color: var(--text-tertiary); margin-top: 2px;">{{ challengeDesc or "" }}</div>
  </div>

  {% if challengeStreak and challengeStreak > 0 %}
    <div class="streak-badge">
      ðŸ”¥ <strong>{{ challengeStreak }}</strong>
    </div>
  {% endif %}
</div>